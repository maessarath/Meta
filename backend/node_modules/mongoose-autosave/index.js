function autoSave(schema, option) {
    var tasks = []
    schema.pre('save', function(next) {
        for(let i in this.schema.tree) {
            if (this[i] && this[i].constructor.name === 'model') {
                tasks.push(this[i].save())
            }
        }
        Promise.all(tasks).then(() => next())
    })
}

module.exports = autoSave

